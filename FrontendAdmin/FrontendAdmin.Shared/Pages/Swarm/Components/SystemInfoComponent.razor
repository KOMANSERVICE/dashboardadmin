@using FrontendAdmin.Shared.Pages.Swarm.Models

<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
    <!-- CPU Card -->
    <div class="bg-white rounded-lg shadow-md p-4 border-l-4 border-blue-500">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-500 uppercase tracking-wide">CPU</p>
                <p class="text-2xl font-bold text-gray-900">@SystemInfo?.NCPU cores</p>
            </div>
            <div class="p-3 bg-blue-100 rounded-full">
                <i class="fas fa-microchip text-blue-600 text-xl"></i>
            </div>
        </div>
        <p class="text-xs text-gray-500 mt-2">@SystemInfo?.Architecture</p>
    </div>

    <!-- Memory Card -->
    <div class="bg-white rounded-lg shadow-md p-4 border-l-4 border-green-500">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-500 uppercase tracking-wide">Memoire</p>
                <p class="text-2xl font-bold text-gray-900">@FormatBytes(SystemInfo?.MemTotal ?? 0)</p>
            </div>
            <div class="p-3 bg-green-100 rounded-full">
                <i class="fas fa-memory text-green-600 text-xl"></i>
            </div>
        </div>
        <p class="text-xs text-gray-500 mt-2">Limite memoire: @(SystemInfo?.MemoryLimit == true ? "Active" : "Inactive")</p>
    </div>

    <!-- Containers Card -->
    <div class="bg-white rounded-lg shadow-md p-4 border-l-4 border-purple-500">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-500 uppercase tracking-wide">Conteneurs</p>
                <p class="text-2xl font-bold text-gray-900">@SystemInfo?.Containers</p>
            </div>
            <div class="p-3 bg-purple-100 rounded-full">
                <i class="fas fa-cube text-purple-600 text-xl"></i>
            </div>
        </div>
        <div class="flex gap-2 mt-2 text-xs">
            <span class="bg-green-100 text-green-800 px-2 py-1 rounded">@SystemInfo?.ContainersRunning running</span>
            <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded">@SystemInfo?.ContainersStopped stopped</span>
        </div>
    </div>

    <!-- Images Card -->
    <div class="bg-white rounded-lg shadow-md p-4 border-l-4 border-orange-500">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm text-gray-500 uppercase tracking-wide">Images</p>
                <p class="text-2xl font-bold text-gray-900">@SystemInfo?.Images</p>
            </div>
            <div class="p-3 bg-orange-100 rounded-full">
                <i class="fas fa-layer-group text-orange-600 text-xl"></i>
            </div>
        </div>
        <p class="text-xs text-gray-500 mt-2">Storage Driver: @SystemInfo?.Driver</p>
    </div>
</div>

<!-- System Details -->
<div class="bg-white rounded-lg shadow-md overflow-hidden mb-6">
    <div class="bg-gray-50 px-6 py-3 border-b">
        <h3 class="text-lg font-semibold text-gray-800">
            <i class="fas fa-info-circle mr-2"></i>Informations Systeme
        </h3>
    </div>
    <div class="p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Left Column -->
            <div class="space-y-4">
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Nom:</span>
                    <span class="font-medium">@SystemInfo?.Name</span>
                </div>
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Systeme:</span>
                    <span class="font-medium">@SystemInfo?.OperatingSystem</span>
                </div>
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Type OS:</span>
                    <span class="font-medium">@SystemInfo?.OSType</span>
                </div>
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Kernel:</span>
                    <span class="font-medium">@SystemInfo?.KernelVersion</span>
                </div>
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Repertoire Docker:</span>
                    <span class="font-medium text-sm">@SystemInfo?.DockerRootDir</span>
                </div>
            </div>
            <!-- Right Column -->
            <div class="space-y-4">
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Version Docker:</span>
                    <span class="font-medium">@SystemInfo?.ServerVersion</span>
                </div>
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Driver Logs:</span>
                    <span class="font-medium">@SystemInfo?.LoggingDriver</span>
                </div>
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Mode Debug:</span>
                    <span class="@GetBoolBadgeClass(SystemInfo?.Debug ?? false) px-2 py-1 rounded text-xs">
                        @(SystemInfo?.Debug == true ? "Actif" : "Inactif")
                    </span>
                </div>
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Experimental:</span>
                    <span class="@GetBoolBadgeClass(SystemInfo?.ExperimentalBuild ?? false) px-2 py-1 rounded text-xs">
                        @(SystemInfo?.ExperimentalBuild == true ? "Actif" : "Inactif")
                    </span>
                </div>
                <div class="flex items-center">
                    <span class="w-40 text-gray-500 text-sm">Heure Systeme:</span>
                    <span class="font-medium">@SystemInfo?.SystemTime.ToString("dd/MM/yyyy HH:mm:ss")</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Capabilities -->
<div class="bg-white rounded-lg shadow-md overflow-hidden">
    <div class="bg-gray-50 px-6 py-3 border-b">
        <h3 class="text-lg font-semibold text-gray-800">
            <i class="fas fa-cogs mr-2"></i>Capacites
        </h3>
    </div>
    <div class="p-6">
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="flex items-center gap-2">
                <i class="@GetCapabilityIcon(SystemInfo?.MemoryLimit ?? false)"></i>
                <span class="text-sm">Memory Limit</span>
            </div>
            <div class="flex items-center gap-2">
                <i class="@GetCapabilityIcon(SystemInfo?.SwapLimit ?? false)"></i>
                <span class="text-sm">Swap Limit</span>
            </div>
            <div class="flex items-center gap-2">
                <i class="@GetCapabilityIcon(SystemInfo?.CpuCfsPeriod ?? false)"></i>
                <span class="text-sm">CPU CFS Period</span>
            </div>
            <div class="flex items-center gap-2">
                <i class="@GetCapabilityIcon(SystemInfo?.CpuCfsQuota ?? false)"></i>
                <span class="text-sm">CPU CFS Quota</span>
            </div>
            <div class="flex items-center gap-2">
                <i class="@GetCapabilityIcon(SystemInfo?.CPUShares ?? false)"></i>
                <span class="text-sm">CPU Shares</span>
            </div>
            <div class="flex items-center gap-2">
                <i class="@GetCapabilityIcon(SystemInfo?.IPv4Forwarding ?? false)"></i>
                <span class="text-sm">IPv4 Forwarding</span>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter] public SystemInfoDto? SystemInfo { get; set; }

    private string FormatBytes(long bytes)
    {
        string[] sizes = { "B", "KB", "MB", "GB", "TB" };
        int order = 0;
        double size = bytes;
        while (size >= 1024 && order < sizes.Length - 1)
        {
            order++;
            size /= 1024;
        }
        return $"{size:0.##} {sizes[order]}";
    }

    private string GetBoolBadgeClass(bool value)
    {
        return value ? "bg-green-100 text-green-800" : "bg-gray-100 text-gray-800";
    }

    private string GetCapabilityIcon(bool enabled)
    {
        return enabled
            ? "fas fa-check-circle text-green-500"
            : "fas fa-times-circle text-gray-400";
    }
}
